"""
TreeCycle Parameter Configuration Guide

æ ‘-ç¯å›¾å‚æ•°é…ç½®æŒ‡å—ï¼Œç”¨äº scalability æµ‹è¯•

èŠ‚ç‚¹æ•°é‡è®¡ç®—ï¼šN â‰ˆ b^(d+1) / (b-1)
- b = branching_factorï¼ˆåˆ†æ”¯å› å­ï¼‰
- d = depthï¼ˆæ ‘æ·±åº¦ï¼‰

================================================
é…ç½®æ–¹æ¡ˆå¯¹æ¯”
================================================

1. å°è§„æ¨¡ï¼ˆæœ¬åœ°æµ‹è¯•ï¼‰
   depth=3, branching_factor=5
   â†’ 156 nodes
   â†’ ç”¨é€”ï¼šæœ¬åœ°è°ƒè¯•ï¼ŒéªŒè¯ä»£ç æ­£ç¡®æ€§

2. ä¸­ç­‰è§„æ¨¡
   depth=4, branching_factor=10
   â†’ 11,111 nodes
   â†’ ç”¨é€”ï¼šä¸­ç­‰è§„æ¨¡æµ‹è¯•

3. å¤§è§„æ¨¡
   depth=5, branching_factor=15
   â†’ 759,375 nodes (~76ä¸‡)
   
   depth=6, branching_factor=20
   â†’ 8,439,345 nodes (~840ä¸‡)
   â†’ ç”¨é€”ï¼šHPC æ€§èƒ½æµ‹è¯•

4. è¶…å¤§è§„æ¨¡
   depth=6, branching_factor=30
   â†’ 24,137,569 nodes (~2400ä¸‡)
   
   depth=7, branching_factor=25
   â†’ 152,587,890 nodes (~1.5äº¿)
   
   depth=7, branching_factor=30
   â†’ 1,098,437,886 nodes (~11äº¿) â­ï¸ Billion-scale!

================================================
Billion-Level é…ç½®æ¨è
================================================

æ–¹æ¡ˆ A: depth=7, branching_factor=30
- èŠ‚ç‚¹æ•°: ~1.1 billion (1,098,437,886)
- è¾¹æ•°: ~1.1 billion tree edges + cycle edges
- å†…å­˜éœ€æ±‚: ~80-100 GBï¼ˆä»…å­˜å‚¨å›¾ç»“æ„ï¼‰
- ç”Ÿæˆæ—¶é—´: 2-4 hours
- æ¨èç”¨äº: Scalability æé™æµ‹è¯•

æ–¹æ¡ˆ B: depth=7, branching_factor=25 (æ›´ä¿å®ˆ)
- èŠ‚ç‚¹æ•°: ~153 million (152,587,890)
- è¾¹æ•°: ~153 million tree edges + cycle edges
- å†…å­˜éœ€æ±‚: ~20-30 GB
- ç”Ÿæˆæ—¶é—´: 30-60 minutes
- æ¨èç”¨äº: å¤§è§„æ¨¡æµ‹è¯•ï¼ˆæ›´ç¨³å®šï¼‰

æ–¹æ¡ˆ C: depth=6, branching_factor=30
- èŠ‚ç‚¹æ•°: ~24 million (24,137,569)
- è¾¹æ•°: ~24 million tree edges + cycle edges
- å†…å­˜éœ€æ±‚: ~5-8 GB
- ç”Ÿæˆæ—¶é—´: 10-15 minutes
- æ¨èç”¨äº: å¿«é€Ÿå¤§è§„æ¨¡éªŒè¯

================================================
cycle_probï¼ˆç¯è¾¹æ¦‚ç‡ï¼‰è®¾ç½®å»ºè®®
================================================

cycle_prob æ§åˆ¶åŒå±‚èŠ‚ç‚¹é—´æ·»åŠ ç¯è¾¹çš„æ¦‚ç‡

- cycle_prob=0.1 (ç¨€ç–ç¯)
  * è¾¹æ•°: ~N (æ ‘è¾¹ä¸ºä¸»)
  * çº¦æŸä¼ æ’­éš¾åº¦: ä½
  * é€‚ç”¨äº: è¶…å¤§è§„æ¨¡å›¾ï¼ˆå‡å°‘å†…å­˜ï¼‰

- cycle_prob=0.3 (ä¸­ç­‰å¯†åº¦) â­ï¸ æ¨è
  * è¾¹æ•°: ~2-3N
  * çº¦æŸä¼ æ’­éš¾åº¦: ä¸­ç­‰
  * é€‚ç”¨äº: å¹³è¡¡æµ‹è¯•

- cycle_prob=0.5 (å¯†é›†ç¯)
  * è¾¹æ•°: ~5-10N
  * çº¦æŸä¼ æ’­éš¾åº¦: é«˜
  * é€‚ç”¨äº: å°è§„æ¨¡å›¾

**å¯¹äº Billion-levelï¼Œå»ºè®® cycle_prob=0.05-0.1**
åŸå› ï¼šåŒå±‚èŠ‚ç‚¹æ•°é‡å·¨å¤§ï¼ˆå¦‚ç¬¬7å±‚æœ‰30^7ä¸ªèŠ‚ç‚¹ï¼‰ï¼Œ
å³ä½¿å¾ˆå°çš„æ¦‚ç‡ä¹Ÿä¼šäº§ç”Ÿå¤§é‡ç¯è¾¹

================================================
å†…å­˜å’Œå­˜å‚¨ä¼°ç®—
================================================

æ¯ä¸ªèŠ‚ç‚¹éœ€è¦ï¼š
- Node features: 5 types Ã— 4 bytes = 20 bytes
- Edge index: å¹³å‡åº¦æ•° Ã— 8 bytes

å¯¹äº 1.1 billion èŠ‚ç‚¹ï¼Œcycle_prob=0.1ï¼š
- Node features: 1.1B Ã— 20 bytes â‰ˆ 22 GB
- Edges: 1.1B Ã— 2 (avg degree) Ã— 8 bytes â‰ˆ 17.6 GB
- æ€»è®¡: ~40-50 GB (PyTorch tensors)

æ¨è HPC é…ç½®ï¼š
- å†…å­˜: 128-256 GB
- å­˜å‚¨: 100 GB ç©ºé—²ç©ºé—´
- æ—¶é—´: 12-24 hours

================================================
ç”Ÿæˆç­–ç•¥
================================================

ç­–ç•¥ 1: ç›´æ¥ç”Ÿæˆï¼ˆæ¨èç”¨äº < 100M èŠ‚ç‚¹ï¼‰
```bash
python TreeCycleGenerator.py --depth 6 --branching-factor 30 --cycle-prob 0.1
```

ç­–ç•¥ 2: åˆ†æ‰¹ç”Ÿæˆï¼ˆæ¨èç”¨äº > 100M èŠ‚ç‚¹ï¼‰
- å…ˆç”Ÿæˆæ ‘ç»“æ„
- å†åˆ†å±‚æ·»åŠ ç¯è¾¹
- ä¿å­˜ä¸ºåˆ†å—æ–‡ä»¶

ç­–ç•¥ 3: æ¸è¿›å¼ç”Ÿæˆ
- ä»å°å›¾å¼€å§‹ï¼šdepth=5, bf=20 (~3M nodes)
- é€æ­¥å¢å¤§ï¼šdepth=6, bf=25 (~12M nodes)
- æœ€ç»ˆç›®æ ‡ï¼šdepth=7, bf=30 (~1.1B nodes)

================================================
å®éªŒæµç¨‹
================================================

é˜¶æ®µ 1: éªŒè¯é˜¶æ®µï¼ˆæœ¬åœ°ï¼‰
1. ç”Ÿæˆå°å›¾: depth=3, bf=5 (156 nodes)
2. è®­ç»ƒæ¨¡å‹: 100 epochs
3. æµ‹è¯• explainer: HeuChase, ApxChase
4. éªŒè¯çº¦æŸå’Œ witness ç”Ÿæˆ
âœ“ å·²å®Œæˆ

é˜¶æ®µ 2: ä¸­ç­‰è§„æ¨¡æµ‹è¯•ï¼ˆHPCï¼‰
1. ç”Ÿæˆå›¾: depth=5, bf=15 (~76ä¸‡ nodes) â­ï¸ å½“å‰é˜¶æ®µ
2. è®­ç»ƒæ¨¡å‹: ä½¿ç”¨ mini-batch training
3. æµ‹è¯• explainer: 100 ä¸ªç›®æ ‡èŠ‚ç‚¹
4. è®°å½•æ€§èƒ½æŒ‡æ ‡

é˜¶æ®µ 3: å¤§è§„æ¨¡æµ‹è¯•ï¼ˆHPCï¼‰
1. ç”Ÿæˆå›¾: depth=6, bf=25 (~12M nodes)
2. è®­ç»ƒæ¨¡å‹: åˆ†å¸ƒå¼è®­ç»ƒ
3. æµ‹è¯• explainer: åˆ†å¸ƒå¼ witness generation
4. Scalability åˆ†æ

é˜¶æ®µ 4: Billion-scale æµ‹è¯•ï¼ˆHPCï¼‰
1. ç”Ÿæˆå›¾: depth=7, bf=30 (~1.1B nodes)
2. è®­ç»ƒæ¨¡å‹: å¤§è§„æ¨¡åˆ†å¸ƒå¼è®­ç»ƒ
3. æµ‹è¯• explainer: å¤§è§„æ¨¡åˆ†å¸ƒå¼ witness generation
4. å‘è¡¨è®ºæ–‡ï¼ğŸ‰

================================================
æ¨èçš„æ¸è¿›å¼è·¯å¾„
================================================

Step 1: ä¸­ç­‰è§„æ¨¡ (ä»Šå¤©)
depth=5, branching_factor=15, cycle_prob=0.2
â†’ 759,375 nodes (~76ä¸‡)
â†’ éªŒè¯æµç¨‹ + åˆæ­¥æ€§èƒ½æ•°æ®

Step 2: å¤§è§„æ¨¡ (æ˜å¤©)
depth=6, branching_factor=20, cycle_prob=0.15
â†’ 8,439,345 nodes (~840ä¸‡)
â†’ Scalability æµ‹è¯•

Step 3: è¶…å¤§è§„æ¨¡ (åå¤©)
depth=6, branching_factor=30, cycle_prob=0.1
â†’ 24,137,569 nodes (~2400ä¸‡)
â†’ æ¥è¿‘ billion-scale æ€§èƒ½

Step 4: Billion-scale (æœ€ç»ˆ)
depth=7, branching_factor=30, cycle_prob=0.05
â†’ 1,098,437,886 nodes (~11äº¿)
â†’ è®ºæ–‡çº§åˆ«å®éªŒ

================================================
"""

# èŠ‚ç‚¹æ•°é‡è®¡ç®—å™¨
def calculate_nodes(depth, branching_factor):
    """è®¡ç®— Tree-Cycle å›¾çš„èŠ‚ç‚¹æ•°é‡"""
    if branching_factor == 1:
        return depth + 1
    return (branching_factor ** (depth + 1) - 1) // (branching_factor - 1)


if __name__ == '__main__':
    print("TreeCycle èŠ‚ç‚¹æ•°é‡è®¡ç®—å™¨")
    print("="*50)
    
    configs = [
        (3, 5, "å°è§„æ¨¡ï¼ˆæœ¬åœ°æµ‹è¯•ï¼‰"),
        (4, 10, "ä¸­ç­‰è§„æ¨¡"),
        (5, 15, "å¤§è§„æ¨¡å…¥é—¨"),
        (6, 20, "å¤§è§„æ¨¡"),
        (6, 25, "è¶…å¤§è§„æ¨¡"),
        (6, 30, "è¶…å¤§è§„æ¨¡+"),
        (7, 25, "æ¥è¿‘ Billion"),
        (7, 30, "Billion-scale â­ï¸"),
    ]
    
    for depth, bf, desc in configs:
        nodes = calculate_nodes(depth, bf)
        print(f"depth={depth}, bf={bf:2d} â†’ {nodes:>15,} nodes  ({desc})")
